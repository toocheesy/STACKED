<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STACKED! - Strategic Card Combat</title>
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#331E0F">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Cabin', Arial, sans-serif;
    }

    body {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><rect width="100%" height="100%" fill="%23331E0F" /><path d="M0 10 Q50 15 100 10 T100 30 T100 70 T0 60 T0 40 T0 20 T0 10" fill="none" stroke="%234A2B17" stroke-width="2" opacity="0.5" /><rect width="100%" height="100%" fill="rgba(0,0,0,0.2)" /></svg>') repeat;
      background-color: #331E0F;
      color: #D2A679;
      height: 100vh;
      height: 100dvh;
      width: 100vw;
      overflow: hidden;
      position: fixed;
      top: 0;
      left: 0;
      touch-action: manipulation;
      -webkit-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    /* ---- Orientation overlay ---- */
    .orientation-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.95);
      color: #D2A679;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      font-size: 1.2rem;
      text-align: center;
      padding: 20px;
      line-height: 1.4;
    }

    @media screen and (orientation: portrait) and (max-width: 768px) {
      .orientation-overlay { display: flex; }
      .split-layout { display: none !important; }
    }

    /* ---- Welcome modal ---- */
    .welcome-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
    }

    .welcome-modal {
      background: linear-gradient(145deg, #331E0F, #4A2B17);
      border: 3px solid #8B5A2B;
      border-radius: 15px;
      padding: 18px 24px;
      max-width: 500px;
      width: 92%;
      max-height: 85dvh;
      overflow-y: auto;
      color: #F5E8C7;
      text-align: center;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7);
    }

    .welcome-modal h2 {
      color: #D2A679;
      font-size: 1.3rem;
      margin-bottom: 10px;
    }

    .welcome-rules p {
      color: #D2A679;
      font-size: 0.85rem;
      margin-bottom: 5px;
      line-height: 1.4;
      text-align: left;
    }

    .welcome-rules p strong { color: #D4A44A; }

    .welcome-btn {
      margin-top: 14px;
      padding: 10px 32px;
      background: linear-gradient(135deg, #8B5A2B, #A0692E);
      color: #F5E8C7;
      border: 2px solid #D4A44A;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      min-height: 44px;
    }

    /* ---- Rules button ---- */
    .rules-btn {
      position: fixed;
      top: 8px;
      right: 8px;
      background: linear-gradient(135deg, #4A2B17, #331E0F);
      border: 2px solid #8B5A2B;
      color: #D2A679;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      font-size: 1.1rem;
      cursor: pointer;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      padding: 0;
      line-height: 1;
    }

    /* ---- Split layout ---- */
    .split-layout {
      width: 100%;
      height: 100%;
      display: grid;
      grid-template-columns: 1fr 1.5fr;
      align-items: center;
    }

    /* Left column — branding */
    .brand-col {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 20px;
      border-right: 1px solid rgba(255,255,255,0.1);
      height: 100%;
    }

    .logo-card {
      width: 80px;
      height: 110px;
      background: linear-gradient(145deg, #C62828, #B71C1C);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
      border: 3px solid #5D4037;
    }

    .logo-card-inner {
      width: 58px;
      height: 80px;
      background: #FFF8DC;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: #C62828;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }

    .logo-title {
      font-size: 2.4rem;
      font-weight: bold;
      color: #D2A679;
      text-shadow: 0 4px 8px rgba(0,0,0,0.8);
      letter-spacing: 4px;
    }

    .logo-tagline {
      font-size: 0.85rem;
      color: #8B5A2B;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    /* Right column — controls */
    .controls-col {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      padding: 20px;
    }

    .difficulty-label {
      font-size: 0.9rem;
      color: #D2A679;
      font-weight: bold;
      letter-spacing: 1px;
    }

    .difficulty-row {
      display: flex;
      gap: 10px;
    }

    .ai-card {
      background: linear-gradient(135deg, #4A2B17, #331E0F);
      border: 2px solid #8B5A2B;
      border-radius: 8px;
      padding: 8px 16px;
      min-width: 100px;
      min-height: 44px;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: bold;
      color: #D2A679;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      transition: all 0.2s ease;
      position: relative;
    }

    .ai-card:hover {
      border-color: #D2A679;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(139, 90, 43, 0.4);
    }

    .ai-card.selected {
      background: #FFF8DC;
      color: #3E2723;
      border-color: #D2A679;
      box-shadow: 0 4px 16px rgba(210, 166, 121, 0.6);
    }

    .ai-card.selected::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 3px;
      background: #4CAF50;
      border-radius: 2px;
    }

    .ai-card.coming-soon-ai {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .ai-card .coming-soon-tag {
      display: block;
      font-size: 0.5rem;
      color: #f39c12;
      letter-spacing: 0.5px;
      margin-top: 2px;
    }

    .ai-card.selected .coming-soon-tag {
      color: #e67e22;
    }

    .play-btn {
      background: linear-gradient(135deg, #4CAF50, #388E3C);
      color: #FFF8DC;
      border: 2px solid #4CAF50;
      border-radius: 10px;
      padding: 14px 48px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 2px;
      min-height: 50px;
      box-shadow: 0 4px 16px rgba(76, 175, 80, 0.4);
      transition: all 0.2s ease;
    }

    .play-btn:hover {
      background: linear-gradient(135deg, #388E3C, #2E7D32);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.6);
    }

    .play-btn:active {
      transform: scale(0.97);
    }

    .coming-soon-badges {
      display: flex;
      gap: 12px;
    }

    .badge {
      font-size: 0.7rem;
      color: #8B5A2B;
      padding: 4px 10px;
      border: 1px solid rgba(139, 90, 43, 0.3);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .badge:hover {
      color: #D2A679;
      border-color: #8B5A2B;
    }

    /* ---- Particles ---- */
    .particles {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #8B5A2B;
      border-radius: 50%;
      animation: float 20s infinite linear;
      opacity: 0.1;
    }

    @keyframes float {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 0.1; }
      90% { opacity: 0.1; }
      100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
    }

    /* ---- Landscape mobile tweaks ---- */
    @media (max-height: 500px) {
      .brand-col { padding: 10px; gap: 4px; }
      .logo-card { width: 60px; height: 84px; }
      .logo-card-inner { width: 42px; height: 60px; font-size: 1.5rem; }
      .logo-title { font-size: 1.8rem; letter-spacing: 3px; }
      .logo-tagline { font-size: 0.7rem; }
      .controls-col { padding: 10px; gap: 10px; }
      .difficulty-label { font-size: 0.8rem; }
      .ai-card { padding: 6px 12px; font-size: 0.75rem; min-width: 85px; }
      .play-btn { padding: 10px 36px; font-size: 0.95rem; }
      .badge { font-size: 0.6rem; }
    }

    /* ---- Tablet / Desktop ---- */
    @media (min-width: 769px) and (min-height: 500px) {
      .logo-card { width: 100px; height: 140px; }
      .logo-card-inner { width: 72px; height: 100px; font-size: 2.5rem; }
      .logo-title { font-size: 3.2rem; }
      .logo-tagline { font-size: 1rem; }
      .controls-col { gap: 24px; }
      .difficulty-label { font-size: 1.1rem; }
      .ai-card { padding: 10px 24px; font-size: 1rem; min-width: 120px; }
      .play-btn { padding: 16px 60px; font-size: 1.3rem; }
      .badge { font-size: 0.85rem; padding: 6px 14px; }
    }
  </style>
</head>
<body>
  <!-- Orientation overlay -->
  <div class="orientation-overlay">
    Please rotate your device to landscape mode for the best STACKED! experience
  </div>

  <!-- Welcome modal (first visit) -->
  <div class="welcome-overlay" id="welcome-overlay" style="display: none;">
    <div class="welcome-modal">
      <h2>Welcome to STACKED!</h2>
      <div class="welcome-rules">
        <p>Capture cards. Score points. Outsmart the bots.</p>
        <p><strong>GOAL:</strong> First to 300 points wins</p>
        <p><strong>CAPTURES:</strong> Match pairs (K+K) or add numbers (3+7=10)</p>
        <p><strong>THAT'S IT:</strong> Pick your difficulty and let's play!</p>
      </div>
      <button class="welcome-btn" onclick="dismissWelcome()">Let's Go!</button>
    </div>
  </div>

  <!-- Rules button -->
  <button class="rules-btn" onclick="showWelcome()">?</button>

  <!-- Particles -->
  <div class="particles" id="particles"></div>

  <!-- Main split layout -->
  <div class="split-layout">
    <!-- Left — Branding -->
    <div class="brand-col">
      <div class="logo-card">
        <div class="logo-card-inner">S!</div>
      </div>
      <div class="logo-title">STACKED!</div>
      <div class="logo-tagline">Strategic Card Combat</div>
    </div>

    <!-- Right — Controls -->
    <div class="controls-col">
      <div class="difficulty-label">Choose Difficulty:</div>

      <div class="difficulty-row">
        <div class="ai-card selected" data-difficulty="beginner">Beginner</div>
        <div class="ai-card" data-difficulty="intermediate">Intermediate</div>
        <div class="ai-card coming-soon-ai" data-difficulty="legendary">
          Legendary
          <span class="coming-soon-tag">Coming Soon</span>
        </div>
      </div>

      <button class="play-btn" onclick="playClassic()">Play Classic</button>

      <div class="coming-soon-badges">
        <span class="badge" onclick="showComingSoon('adventure')">Adventure — soon</span>
        <span class="badge" onclick="showComingSoon('tournament')">Tournament — soon</span>
      </div>
    </div>
  </div>

  <script>
    // Particles
    function createParticles() {
      const container = document.getElementById('particles');
      for (let i = 0; i < 40; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = Math.random() * 100 + '%';
        p.style.animationDelay = Math.random() * 20 + 's';
        p.style.animationDuration = (15 + Math.random() * 10) + 's';
        container.appendChild(p);
      }
    }

    // AI pairings
    const DIFFICULTY_PAIRINGS = {
      beginner:     { bot1: 'calvin', bot2: 'calvin' },
      intermediate: { bot1: 'calvin', bot2: 'nina' },
      legendary:    { bot1: 'nina',   bot2: 'rex' }
    };

    // Play
    function playClassic() {
      const selected = document.querySelector('.ai-card.selected');
      const difficulty = selected ? selected.dataset.difficulty : 'beginner';
      const pairing = DIFFICULTY_PAIRINGS[difficulty] || DIFFICULTY_PAIRINGS.beginner;

      localStorage.setItem('selectedMode', 'classic');
      localStorage.setItem('bot1Personality', pairing.bot1);
      localStorage.setItem('bot2Personality', pairing.bot2);

      const btn = document.querySelector('.play-btn');
      btn.style.transform = 'scale(0.95)';
      setTimeout(() => { window.location.href = 'game.html'; }, 100);
    }

    function showComingSoon(mode) {
      const names = { adventure: 'Adventure Mode', tournament: 'Tournament Mode' };
      alert(`${names[mode] || mode} is coming soon!`);
    }

    // AI card selection
    function setupAICardSelection() {
      const cards = document.querySelectorAll('.ai-card');

      cards.forEach(card => {
        card.addEventListener('click', () => {
          if (card.classList.contains('coming-soon-ai')) return;
          cards.forEach(c => c.classList.remove('selected'));
          card.classList.add('selected');

          const difficulty = card.dataset.difficulty;
          const pairing = DIFFICULTY_PAIRINGS[difficulty] || DIFFICULTY_PAIRINGS.beginner;
          localStorage.setItem('bot1Personality', pairing.bot1);
          localStorage.setItem('bot2Personality', pairing.bot2);
        });
      });

      // Restore saved selection
      const savedBot1 = localStorage.getItem('bot1Personality') || 'calvin';
      let savedDifficulty = 'beginner';
      for (const [diff, pair] of Object.entries(DIFFICULTY_PAIRINGS)) {
        if (pair.bot1 === savedBot1) { savedDifficulty = diff; break; }
      }
      const savedCard = document.querySelector(`[data-difficulty="${savedDifficulty}"]`);
      if (savedCard) {
        cards.forEach(c => c.classList.remove('selected'));
        savedCard.classList.add('selected');
      }
    }

    // Welcome modal
    function showWelcome() {
      document.getElementById('welcome-overlay').style.display = 'flex';
    }

    function dismissWelcome() {
      document.getElementById('welcome-overlay').style.display = 'none';
      localStorage.setItem('stacked_welcomed', 'true');
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      createParticles();
      setupAICardSelection();
      if (!localStorage.getItem('stacked_welcomed')) {
        showWelcome();
      }
    });
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }
  </script>
</body>
</html>
